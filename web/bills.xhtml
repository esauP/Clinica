<!DOCTYPE html>
<html lang="es"  xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://xmlns.jcp.org/jsf/html"
xmlns:p="http://primefaces.org/ui"
xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head>
<meta charset="utf-8" />
<title>Clínica Veterinaria</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="" />
<!-- css -->
<link href="css/bootstrap.min.css" rel="stylesheet" />
<link href="css/fancybox/jquery.fancybox.css" rel="stylesheet" />
<link href="css/jcarousel.css" rel="stylesheet" />
<link href="css/flexslider.css" rel="stylesheet" />
<link href="js/owl-carousel/owl.carousel.css" rel="stylesheet" />
<link href="css/style.css" rel="stylesheet" />
</h:head>
<h:body>
<div id="wrapper">
  <!-- start header -->
  <header>
    <div class="navbar navbar-default navbar-static-top"  >
      <div class="container" >
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="adminHome.xhtml"><img src="img/logo.png" alt="logo"/></a>
        </div>
        <div class="navbar-collapse collapse ">
          <ul class="nav navbar-nav">
            <li><a href="pets.xhtml">Mascotas</a></li>
            <li><a href="consultation.xhtml">Consulta | Historial</a></li>
            <li><a href="dates.xhtml">Citas</a></li>
            <li><a href="bills.xhtml">Facturación</a></li>
            <li><a href="vaccines.xhtml">Vacunas</a></li>
            <li>
              <a>
                <h:form>
                <p:commandButton actionListener="#{loginBean.desloguear(event)}">
                <h:graphicImage name="img/salir.png" />
              </p:commandButton>
            </h:form>
          </a>
        </li>
      </ul>
    </div>
  </div>
</div>
</header>
</div>
<!-- end header -->

<section id="content">
  <div class="container">
    <div class="row">
      <div class="skill-home"> <div class="skill-home-solid clearfix">
        <div class="col-md-3 text-left">
          <h3>Lista de productos y servicios</h3>
          <!--Comienzo del list de búsqueda-->
          <h:form>
          <h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5" columnClasses="label, value">
          <p:selectOneListbox id="advanced" value="#{selectOneView.theme}"  var="t" filter="true" filterMatchMode="contains">
          <f:selectItems value="#{selectOneView.themes}" var="theme" itemLabel="#{theme.displayName}" itemValue="#{theme}" />
          <p:column>
          <h:outputText styleClass="ui-theme ui-theme-#{t.name}" />
        </p:column>
        <p:column>
        <h:outputText value="#{t.displayName}" />
      </p:column>
    </p:selectOneListbox>
  </h:panelGrid>
  <p:separator />
  <p:commandButton value="Añadir Producto" update="display" oncomplete="PF('dlg').show()" icon="ui-icon-check" />
  <p:panelGrid columns="2" id="display" columnClasses="label,output">
</p:panelGrid>
</h:form>
<!--fin del list de búsqueda -->
</div>
<div class="col-md-9 text-left">
  <div class="billInfo">
    <h:form id="insertBill">

    <p:spacer width="20"  height="0"/>
    <!-- combobox de mascotas  -->
    <p:growl id = "msgs" showDetail = "true" />
    <p:panel style = "margin-bottom:10px;">
    <h:panelGrid columns="10" cellpadding="5">
    <p:autoComplete value="#{billBean.idper}" completeMethod="#{personBean.AutocompletarID}" placeholder="* Nombre Apellidos"/>
    <p:selectOneMenu value="#petsBean.petM.getName()}">
        <f:selectItems value="#{petsBean.listamascotas}"/>
    </p:selectOneMenu>
  <h:outputText id = "idBill" value = "#{billBean.idbill}"/>
  <!-- fecha del día para la factura -->
  <h:outputText value="#{now}">
  <f:convertDateTime pattern="MM/dd/yyyy" type="date" />
</h:outputText>
<!-- fin de la fecha -->
</h:panelGrid>
</p:panel>
<p:commandButton value="Buscar" update="msgs"  icon="ui-icon-check" />
<p:spacer width="20"  height="0"/>
<!-- fin del combobox de mascotas-->

<h:outputText id = "description" value = "#{billBean.observations}" />
</h:form>
</div>

<!-- tabla con las líneas de factura -->
<div>
  <h:form id="tablaFacturas">
  <p:dataTable id="Facturas" var="fact" value="#{billLineBeans.listalineasfac}" editable="true" style="margin-bottom:20px">
  <f:facet name="header">Factura</f:facet>

  <p:ajax event="rowEdit" listener="#{billLineBeans.onRowEdit}"  />
  <p:ajax event="rowEditCancel" listener="#{billLineBeans.onRowCancel}" />

  <p:column headerText="Linea">
  <h:outputText value="#{fact.idbill_lines}" />
</p:column>

<p:column headerText="Factura">
<p:cellEditor>
<f:facet name="output"><h:outputText value="#{fact.idbill}" /></f:facet>
<f:facet name="input"><p:inputText value="#{fact.idbill}" style="width:100%" label="idBill"/></f:facet>
</p:cellEditor>
</p:column>

<p:column headerText="Producto">
<p:cellEditor>
<f:facet name="output"><h:outputText value="#{fact.idproduct}" /></f:facet>
<f:facet name="input"><p:inputText value="#{fact.idproduct}" style="width:100%" label="idProd"/></f:facet>
</p:cellEditor>
</p:column>

<p:column headerText="Cantidad">
<p:cellEditor>
<f:facet name="output"><h:outputText value="#{fact.quantity}" /></f:facet>
<f:facet name="input"><p:inputText value="#{fact.quantity}" style="width:100%" label="quantity"/></f:facet>
</p:cellEditor>
</p:column>

<p:column headerText="PVP">
<p:cellEditor>
<f:facet name="output"><h:outputText value="#{fact.price}" /></f:facet>
<f:facet name="input"><p:inputText value="#{fact.price}" style="width:100%" label="price"/></f:facet>
</p:cellEditor>
</p:column>

<p:column headerText="IVA">
<p:cellEditor>
<f:facet name="output"><h:outputText value="#{fact.taxes}" /></f:facet>
<f:facet name="input"><p:inputText value="#{fact.taxes}" style="width:100%" label="tax"/></f:facet>
</p:cellEditor>
</p:column>

<p:column headerText="Dcto">
<p:cellEditor>
<f:facet name="output"><h:outputText value="#{fact.discount}" /></f:facet>
<f:facet name="input"><p:inputText value="#{fact.discount}" style="width:100%" label="descuento"/></f:facet>
</p:cellEditor>
</p:column>

<p:column headerText="Mascota">
<p:cellEditor>
<f:facet name="output"><h:outputText value="#{fact.idpet}" /></f:facet>
<f:facet name="input"><p:inputText value="#{fact.idpet}" style="width:100%" label="pet"/></f:facet>
</p:cellEditor>
</p:column>

<p:column headerText="Obs.">
<p:cellEditor>
<f:facet name="output"><h:outputText value="#{fact.observations}" /></f:facet>
<f:facet name="input"><p:inputText value="#{fact.observations}" style="width:100%" label="obs"/></f:facet>
</p:cellEditor>
</p:column>

<p:column headerText="Eliminar">
<p:commandLink value="Eliminar"  actionListener="#{BillLineBeans.DeleteLine(fact.idbill_lines)}" update=":tablaFacturas:Facturas"/>
</p:column>

</p:dataTable>

<p:commandButton value="Guardar" actionListener="#{billBean.AddBill()}" /><p:spacer width="20"  height="0"/>
<p:commandButton value="Imprimir Factura"  /><p:spacer width="20"  height="0"/>
<p:commandButton value="Salir sin guardar" /><p:spacer width="20"  height="0"/>
</h:form>
</div>
<!-- fin de la tabla -->


</div>
</div></div></div>
</div>
</section>

<div id="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <ul class="social-network">
          <li><a href="#" data-placement="top" title="Facebook"><i class="fa fa-facebook"></i></a></li>
          <li><a href="#" data-placement="top" title="Twitter"><i class="fa fa-twitter"></i></a></li>
          <li><a href="#" data-placement="top" title="Google plus"><i class="fa fa-google-plus"></i></a></li>
        </ul>
      </div>
    </div>
  </div>
</div>
<a href="#" class="scrollup"><i class="fa fa-angle-up active"></i></a>
<!-- javascript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<!-- script que permite al usuario cerrar el dialogo cuando haga click fuera de el-->
<script>
// Get the modal
var modal = document.getElementById('id01');

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>
<script src="js/jquery.js"></script>
<script src="js/jquery.easing.1.3.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/jquery.fancybox.pack.js"></script>
<script src="js/jquery.fancybox-media.js"></script>
<script src="js/portfolio/jquery.quicksand.js"></script>
<script src="js/portfolio/setting.js"></script>
<script src="js/jquery.flexslider.js"></script>
<script src="js/animate.js"></script>
<script src="js/custom.js"></script>
<script src="js/owl-carousel/owl.carousel.js"></script>
</h:body>
</html>
